version: "3.8"

services:
  redmine:
    image: redmine:latest
    restart: always

    # Railway dynamically assigns a port
    ports:
      - "${PORT}:8080"

    environment:
      # Run in development mode (no secret_key_base needed)
      RAILS_ENV: development

      # Database config (Railway MySQL plugin injects these)
      # DB_ADAPTER: mysql2
      REDMINE_DB_MYSQL: ${MYSQLHOST}
      REDMINE_DB_DATABASE: ${MYSQLDATABASE}
      REDMINE_DB_USERNAME: ${MYSQLUSER}
      REDMINE_DB_PASSWORD: ${MYSQLPASSWORD}

      # Optional Redmine settings
      # REDMINE_RELATIVE_URL_ROOT: ""
      # REDMINE_LANG: en
