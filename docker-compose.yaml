version: "3.8"

services:
  redmine:
    image: sameersbn/redmine:latest
    restart: always

    # Railway dynamically assigns a port
    ports:
      - "${PORT}:3000"

    environment:
      # Run in development mode (no secret_key_base needed)
      RAILS_ENV: development

      # Database config (Railway MySQL plugin injects these)
      DB_ADAPTER: mysql2
      DB_HOST: ${MYSQLHOST}
      DB_PORT: ${MYSQLPORT}
      DB_NAME: ${MYSQLDATABASE}
      DB_USER: ${MYSQLUSER}
      DB_PASS: ${MYSQLPASSWORD}

      # Optional Redmine settings
      REDMINE_RELATIVE_URL_ROOT: ""
      REDMINE_LANG: en
